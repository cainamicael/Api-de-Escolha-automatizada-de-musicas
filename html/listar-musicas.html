<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Listar musicas</title>
    <link rel="stylesheet" href="../css/style-listar-musicas.css">
</head>
<body>
    <div class="container">
        <div class="container cadastrar-musica">
            <h3>Músicas</h3>
            <h1>Cadastradas</h1>
            <div class="tres-partes"></div>
            <div class="tres-partes"></div>
            <div class="tres-partes"></div>
            <div class="clear"></div>
        </div>
    </div>

    <div class="container">
        <div class="conteudo">

            <div class="informacoes">
                <p id="musicas-cadastradas">X MÚSICAS CADASTRADAS</p>
                <p id="musicas-tocadas">X MÚSICAS JÁ TOCADAS</p>
            </div>

            <div class="modulos">
                <div class="modulo">
                    <span>ID:</span>
                    <p>1</p>
    
                    <span>NOME:</span>
                    <p>Nome da música</p>
    
                    <span>QUEM CANTA:</span>
                    <p>Nome de quem canta a música</p>
    
                    <span>CATEGORIA:</span>
                    <p>Adoração</p>
    
                    <span>QUANDO FOI TOCADA: </span>
                    <p>21/08/2023</p>
                </div>
            </div>
            
        </div>   
    </div>   

    <script>
        alert('Quando todas as músicas forem tocadas, a contagem de músicas tocadas irá zerar!')

        const urlBase = 'http://localhost:8080/api/'

        //Setando as músicas cadastradas e tocadas
        fetch(urlBase + 'quantidades')
        .then(resposta => resposta.json())
        .then(quantidades => {
            const musicasCadastradas = quantidades.quantidadeRegistros
            const musicasTocadas = quantidades.quantidadeMusicasTocadas

            //Mudando os textos
            document.getElementById('musicas-cadastradas').innerText = musicasCadastradas + ' MÚSICAS CADASTRADAS'
            
            document.getElementById('musicas-tocadas').innerText = musicasTocadas + ' MÚSICAS JÁ TOCADAS'
        })

        //Pegando cada música dinamicamente
        fetch(urlBase + 'musicas')
        .then(resposta => resposta.json())
        .then(dados => {
            const modulos = document.querySelector('.modulos')
            let adicionar = ''

            dados.forEach(dado => {
                let data;

                if(dado.dataUltimaVezTocada != null) {
                    data = dado.dataUltimaVezTocada
                } else {
                    data = 'A música ainda não foi tocada!'
                }

                adicionar += `
                    <div class="modulo">
                        <span>ID:</span>
                        <p>${dado.id}</p>

                        <span>NOME:</span>
                        <p>${dado.nome}</p>

                        <span>QUEM CANTA:</span>
                        <p>${dado.cantor}</p>

                        <span>CATEGORIA:</span>
                        <p>${dado.categoria}</p>

                        <span>QUANDO FOI TOCADA: </span>
                        <p>${data}</p>
                    </div>
                `
            })

            modulos.innerHTML = adicionar
        })
    </script>
</body>
</html>